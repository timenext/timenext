!function(e){if(!e.BX.ajax){var a=e.BX,t={},r={method:"GET",dataType:"html",timeout:0,async:!0,processData:!0,scriptsRunFirst:!1,emulateOnload:!0,skipAuthCheck:!1,start:!0,cache:!0,preparePost:!0,headers:!1,lsTimeout:30,lsForce:!1},o=null,n={},s={url_utf:/[^\034-\254]+/g,script_self:/\/bitrix\/js\/main\/core\/core(_ajax)*.js$/i,script_self_window:/\/bitrix\/js\/main\/core\/core_window.js$/i,script_self_admin:/\/bitrix\/js\/main\/core\/core_admin.js$/i,script_onload:/window.onload/g};a.ajax=function(e){var o;if(!e||!e.url||!a.type.isString(e.url))return!1;for(var n in t)void 0===e[n]&&(e[n]=t[n]);for(n in t={},r)void 0===e[n]&&(e[n]=r[n]);if(e.method=e.method.toUpperCase(),a.localStorage||(e.lsId=null),a.browser.IsIE()){var i=s.url_utf.exec(e.url);if(i)do{e.url=e.url.replace(i,a.util.urlencode(i)),i=s.url_utf.exec(e.url)}while(i)}"json"==e.dataType&&(e.emulateOnload=!1),e.cache||"GET"!=e.method||(e.url=a.ajax._uncache(e.url)),"POST"==e.method&&e.preparePost&&(e.data=a.ajax.prepareData(e.data));var u=!0;if(e.lsId&&!e.lsForce){var l=a.localStorage.get("ajax-"+e.lsId);if(null!==l){u=!1;var c=function(t){if(t.key=="ajax-"+e.lsId&&"BXAJAXWAIT"!=t.value){var r=t.value;!!t.oldValue&&null==r?e.onfailure&&e.onfailure("timeout"):a.ajax.__run(e,r),a.removeCustomEvent("onLocalStorageChange",c)}};"BXAJAXWAIT"==l?a.addCustomEvent("onLocalStorageChange",c):setTimeout((function(){c({key:"ajax-"+e.lsId,value:l})}),10)}}if(u){if(e.xhr=a.ajax.xhr(),!e.xhr)return;if(e.lsId&&a.localStorage.set("ajax-"+e.lsId,"BXAJAXWAIT",e.lsTimeout),e.xhr.open(e.method,e.url,e.async),e.skipBxHeader||a.ajax.isCrossDomain(e.url)||e.xhr.setRequestHeader("Bx-ajax","true"),"POST"==e.method&&e.preparePost&&e.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),"object"==typeof e.headers)for(n=0;n<e.headers.length;n++)e.xhr.setRequestHeader(e.headers[n].name,e.headers[n].value);e.onprogress&&a.bind(e.xhr,"progress",e.onprogress);var d=!1,p=e.xhr.onreadystatechange=function(t){if(!d)if("timeout"===t)e.onfailure&&e.onfailure("timeout"),a.onCustomEvent(e.xhr,"onAjaxFailure",["timeout","",e]),e.xhr.onreadystatechange=a.DoNothing,e.xhr.abort(),e.async&&(e.xhr=null);else if(4==e.xhr.readyState||"run"==t){if(o=a.ajax.xhrSuccess(e.xhr)?"success":"error",d=!0,e.xhr.onreadystatechange=a.DoNothing,"success"==o){var r=!e.skipAuthCheck&&!a.ajax.isCrossDomain(e.url)&&e.xhr.getResponseHeader("X-Bitrix-Ajax-Status");if(r&&"Authorize"==r)e.onfailure&&e.onfailure("auth",e.xhr.status),a.onCustomEvent(e.xhr,"onAjaxFailure",["auth",e.xhr.status,e]);else{var n=e.xhr.responseText;e.lsId&&a.localStorage.set("ajax-"+e.lsId,n,e.lsTimeout),a.ajax.__run(e,n)}}else e.onfailure&&e.onfailure("status",e.xhr.status),a.onCustomEvent(e.xhr,"onAjaxFailure",["status",e.xhr.status,e]);e.async&&(e.xhr=null)}};return e.async&&e.timeout>0&&setTimeout((function(){e.xhr&&!d&&p("timeout")}),1e3*e.timeout),e.start&&(e.xhr.send(e.data),e.async||p("run")),e.xhr}},a.ajax.xhr=function(){if(e.XMLHttpRequest)try{return new XMLHttpRequest}catch(e){}else if(e.ActiveXObject){try{return new e.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new e.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new e.ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}throw new Error("This browser does not support XMLHttpRequest.")}return null},a.ajax.isCrossDomain=function(t,r){if(r=r||e.location,0===t.indexOf("//")&&(t=r.protocol+t),0!==t.indexOf("http"))return!1;var o=e.document.createElement("a");return o.href=t,o.protocol!==r.protocol||o.hostname!==r.hostname||a.ajax.getHostPort(o.protocol,o.host)!==a.ajax.getHostPort(r.protocol,r.host)},a.ajax.getHostPort=function(e,a){var t=/:(\d+)$/.exec(a);return t?t[1]:"http:"===e?"80":"https:"===e?"443":""},a.ajax.__prepareOnload=function(t){if(t.length>0){a.ajax["onload_"+o]=null;for(var r=0,n=t.length;r<n;r++)t[r].isInternal&&(t[r].JS=t[r].JS.replace(s.script_onload,"BX.ajax.onload_"+o))}a.CaptureEventsGet(),a.CaptureEvents(e,"load")},a.ajax.__runOnload=function(){null!=a.ajax["onload_"+o]&&(a.ajax["onload_"+o].apply(e),a.ajax["onload_"+o]=null);var t=a.CaptureEventsGet();if(t)for(var r=0;r<t.length;r++)t[r].apply(e)},a.ajax.__run=function(e,t){e.processData?t=a.ajax.processRequestData(t,e):(e.onsuccess&&e.onsuccess(t),a.onCustomEvent(e.xhr,"onAjaxSuccess",[t,e]))},a.ajax._onParseJSONFailure=function(e){this.jsonFailure=!0,this.jsonResponse=e,this.jsonProactive=/^\[WAF\]/.test(e)},a.ajax.processRequestData=function(e,t){var r,n=[],s=[];switch(t.dataType.toUpperCase()){case"JSON":if(a.addCustomEvent(t.xhr,"onParseJSONFailure",a.proxy(a.ajax._onParseJSONFailure,t)),r=a.parseJSON(e,t.xhr),a.removeCustomEvent(t.xhr,"onParseJSONFailure",a.proxy(a.ajax._onParseJSONFailure,t)),r&&a.type.isArray(r.bxjs))for(var i=0;i<r.bxjs.length;i++)a.type.isNotEmptyString(r.bxjs[i])?n.push({isInternal:!1,JS:r.bxjs[i],bRunFirst:t.scriptsRunFirst}):n.push(r.bxjs[i]);r&&a.type.isArray(r.bxcss)&&(s=r.bxcss);break;case"SCRIPT":n.push({isInternal:!0,JS:e,bRunFirst:t.scriptsRunFirst}),r=e;break;default:var u=a.processHTML(e,t.scriptsRunFirst);r=u.HTML,n=u.SCRIPT,s=u.STYLE}var l=!1;null==o&&(o=parseInt(1e6*Math.random()),l=!0),s.length>0&&a.loadCSS(s),t.emulateOnload&&a.ajax.__prepareOnload(n);var c=a.DoNothing;(t.emulateOnload||l)&&(c=a.defer((function(){t.emulateOnload&&a.ajax.__runOnload(),l&&(o=null),a.onCustomEvent(t.xhr,"onAjaxSuccessFinish",[t])})));try{if(t.jsonFailure)throw{type:"json_failure",data:t.jsonResponse,bProactive:t.jsonProactive};t.scripts=n,a.ajax.processScripts(t.scripts,!0),t.onsuccess&&t.onsuccess(r),a.onCustomEvent(t.xhr,"onAjaxSuccess",[r,t]),a.ajax.processScripts(t.scripts,!1,c)}catch(e){t.onfailure&&t.onfailure("processing",e),a.onCustomEvent(t.xhr,"onAjaxFailure",["processing",e,t])}},a.ajax.processScripts=function(e,t,r){var o=[],n="";r=r||a.DoNothing;for(var s=0,i=e.length;s<i;s++)void 0!==t&&t!=!!e[s].bRunFirst||(e[s].isInternal?n+=";"+e[s].JS:o.push(e[s].JS));o=a.util.array_unique(o);var u=n.length>0?function(){a.evalGlobal(n)}:a.DoNothing;o.length>0?a.load(o,(function(){u(),r()})):(u(),r())},a.ajax.prepareData=function(e,t){var r="";if(a.type.isString(e))r=e;else if(null!=e)for(var o in e)if(e.hasOwnProperty(o)){r.length>0&&(r+="&");var n=a.util.urlencode(o);t&&(n=t+"["+n+"]"),"object"==typeof e[o]?r+=a.ajax.prepareData(e[o],n):r+=n+"="+a.util.urlencode(e[o])}return r},a.ajax.xhrSuccess=function(e){return e.status>=200&&e.status<300||304===e.status||1223===e.status||0===e.status},a.ajax.Setup=function(e,a){for(var o in a=!!a,e)a?t[o]=e[o]:r[o]=e[o]},a.ajax.replaceLocalStorageValue=function(e,t,r){a.localStorage&&a.localStorage.set("ajax-"+e,t,r)},a.ajax._uncache=function(e){return e+(-1!==e.indexOf("?")?"&":"?")+"_="+(new Date).getTime()},a.ajax.get=function(e,t,r){return a.type.isFunction(t)&&(r=t,t=""),(t=a.ajax.prepareData(t))&&(e+=(-1!==e.indexOf("?")?"&":"?")+t,t=""),a.ajax({method:"GET",dataType:"html",url:e,data:"",onsuccess:r})},a.ajax.getCaptcha=function(e){return a.ajax.loadJSON("/bitrix/tools/ajax_captcha.php",e)},a.ajax.insertToNode=function(e,r){if(r=a(r)){var o={cancel:!1};if(a.onCustomEvent("onAjaxInsertToNode",[{url:e,node:r,eventArgs:o}]),!0===o.cancel)return;var n=null;return t.denyShowWait||(n=a.showWait(r),delete t.denyShowWait),a.ajax.get(e,(function(e){r.innerHTML=e,a.closeWait(r,n)}))}},a.ajax.post=function(e,t,r){return t=a.ajax.prepareData(t),a.ajax({method:"POST",dataType:"html",url:e,data:t,onsuccess:r})},a.ajax.promise=function(e){var t=new a.Promise;e.onsuccess=function(e){t.fulfill(e)},e.onfailure=function(e,a){t.reject({reason:e,data:a})},e.onprogress=function(e){0==e.position&&0==e.totalSize&&t.reject({reason:"progress",data:e})};var r=a.ajax(e);return r?"function"==typeof e.onrequeststart&&e.onrequeststart(r):t.reject({reason:"init",data:!1}),t},a.ajax.loadScriptAjax=function(e,t,r){if(a.type.isArray(e))for(var o=0,i=e.length;o<i;o++)a.ajax.loadScriptAjax(e[o],t,r);else{var u=e.replace(/\.js\?.*/,".js");if(s.script_self.test(u))return;if(s.script_self_window.test(u)&&a.CWindow)return;if(s.script_self_admin.test(u)&&a.admin)return;if(void 0===n[u])return r?(n[u]="",a.loadScript(e)):a.ajax({url:e,method:"GET",dataType:"script",processData:!0,emulateOnload:!1,scriptsRunFirst:!0,async:!1,start:!0,onsuccess:function(e){n[u]=e,t&&t(e)}});t&&t(n[u])}},a.ajax.loadJSON=function(e,t,r,o){return a.type.isFunction(t)&&(o=r,r=t,t=""),(t=a.ajax.prepareData(t))&&(e+=(-1!==e.indexOf("?")?"&":"?")+t,t=""),a.ajax({method:"GET",dataType:"json",url:e,onsuccess:r,onfailure:o})};var i=function(e){var t={};return(a.type.isNotEmptyString(e.analyticsLabel)||a.type.isNotEmptyObject(e.analyticsLabel))&&(t.analyticsLabel=e.analyticsLabel),void 0!==e.mode&&(t.mode=e.mode),e.navigation&&(e.navigation.page&&(t.nav="page-"+e.navigation.page),e.navigation.size&&(t.nav?t.nav+="-":t.nav="",t.nav+="size-"+e.navigation.size)),t},u=function(e){return(e=a.type.isPlainObject(e)?e:{}).data instanceof FormData?(e.preparePost=!1,e.data.append("sessid",a.bitrix_sessid()),a.message.SITE_ID&&e.data.append("SITE_ID",a.message.SITE_ID),void 0!==e.signedParameters&&e.data.append("signedParameters",e.signedParameters)):(e.data=a.type.isPlainObject(e.data)?e.data:{},a.message.SITE_ID&&(e.data.SITE_ID=a.message.SITE_ID),e.data.sessid=a.bitrix_sessid(),void 0!==e.signedParameters&&(e.data.signedParameters=e.signedParameters)),e.method||(e.method="POST"),e},l=function(e,t){t=t||!1;var r=a.clone(e);return a.ajax.promise(e).then((function(e){if(!t&&a.type.isPlainObject(e)&&a.type.isArray(e.errors)){var o=!1;if(e.errors.forEach((function(e){"invalid_csrf"===e.code&&e.customData.csrf&&(a.message({bitrix_sessid:e.customData.csrf}),r.data.sessid=a.bitrix_sessid(),o=!0)})),o)return l(r,!0)}if(!a.type.isPlainObject(e)||"success"!==e.status){var n=new a.Promise;return n.reject(e),n}return e})).catch((function(e){var t=new a.Promise;return a.type.isPlainObject(e)&&e.status&&e.hasOwnProperty("data")?t.reject(e):t.reject({status:"error",data:{ajaxRejectData:e},errors:[{code:"NETWORK_ERROR",message:"Network error"}]}),t}))};a.ajax.runAction=function(e,t){t=u(t);var r=i(t);r.action=e;var o="/bitrix/services/main/ajax.php?"+a.ajax.prepareData(r);return l({method:t.method,dataType:"json",url:o,data:t.data,timeout:t.timeout,preparePost:t.preparePost,headers:t.headers})},a.ajax.runComponentAction=function(e,t,r){(r=u(r)).mode=r.mode||"ajax";var o=i(r);o.c=e,o.action=t;var n="/bitrix/services/main/ajax.php?"+a.ajax.prepareData(o);return l({method:r.method,dataType:"json",url:n,data:r.data,timeout:r.timeout,preparePost:r.preparePost,headers:r.headers})},a.ajax.load=function(e,t){a.type.isArray(e)||(e=[e]);var r=0;a.type.isFunction(t)||(t=a.DoNothing);for(var o=function(e){a.type.isFunction(this.callback)&&this.callback(e),++r>=s&&t()},n=0,s=e.length;n<s;n++)switch(e[n].type.toUpperCase()){case"SCRIPT":a.loadScript([e[n].url],a.proxy(o,e[n]));break;case"CSS":a.loadCSS([e[n].url]),++r>=s&&t();break;case"JSON":a.ajax.loadJSON(e[n].url,a.proxy(o,e[n]));break;default:a.ajax.get(e[n].url,"",a.proxy(o,e[n]))}},a.ajax.submit=function(e,t){if(!e.target){if(null==e.BXFormTarget){var r="formTarget_"+Math.random();e.BXFormTarget=document.body.appendChild(a.create("IFRAME",{props:{name:r,id:r,src:"javascript:void(0)"},style:{display:"none"}}))}e.target=e.BXFormTarget.name}return e.BXFormCallback=t,a.bind(e.BXFormTarget,"load",a.proxy(a.ajax._submit_callback,e)),a.submit(e),!1},a.ajax.submitComponentForm=function(t,r,o){if(!t.target){if(null==t.BXFormTarget){var n="formTarget_"+Math.random();t.BXFormTarget=document.body.appendChild(a.create("IFRAME",{props:{name:n,id:n,src:"javascript:void(0)"},style:{display:"none"}}))}t.target=t.BXFormTarget.name}if(o)var s=a.showWait(r);return t.BXFormCallback=function(t){o&&a.closeWait(s);a(r).innerHTML=t,a.onCustomEvent("onAjaxSuccess",[null,null,function(){e.bxcompajaxframeonload&&setTimeout((function(){e.bxcompajaxframeonload(),e.bxcompajaxframeonload=null}),10)}])},a.bind(t.BXFormTarget,"load",a.proxy(a.ajax._submit_callback,t)),!0},a.ajax._submit_callback=function(){try{if(0!=this.BXFormTarget.contentWindow.location.href.indexOf("http"))return}catch(e){return}this.BXFormCallback&&this.BXFormCallback.apply(this,[this.BXFormTarget.contentWindow.document.body.innerHTML]),a.unbindAll(this.BXFormTarget)},a.ajax.prepareForm=function(e,a){a=a||{};var t,r,o,n=[],s=e.elements.length,i=0,u=0;if(e){for(t=0;t<s;t++)if(!(o=e.elements[t]).disabled&&o.type)switch(o.type.toLowerCase()){case"text":case"textarea":case"password":case"number":case"hidden":case"select-one":n.push({name:o.name,value:o.value}),u+=o.name.length+o.value.length;break;case"file":if(o.files)for(r=0;r<o.files.length;r++)i++,n.push({name:o.name,value:o.files[r],file:!0}),u+=o.files[r].size;break;case"radio":case"checkbox":o.checked&&(n.push({name:o.name,value:o.value}),u+=o.name.length+o.value.length);break;case"select-multiple":for(var l=0;l<o.options.length;l++)o.options[l].selected&&(n.push({name:o.name,value:o.options[l].value}),u+=o.name.length+o.options[l].length)}t=0,u=0;for(var c,d,p,h,x=a;t<n.length;){var m=n[t].name.indexOf("[");h?(x[n[t].name]={},x[n[t].name][h.replace(/\[|\]/gi,"")]=n[t].value,x=a,h=null,t++):-1==m?(x[n[t].name]=n[t].value,x=a,t++):(c=n[t].name.substring(0,m),-1==(p=(d=n[t].name.substring(m+1)).indexOf("]"))?(x[c]||(x[c]=[]),x=a,t++):0==p?(x[c]||(x[c]=[]),x=x[c],n[t].name=""+x.length,0===d.substring(p+1).indexOf("[")&&(h=d.substring(0,p)+d.substring(p+1))):(x[c]||(x[c]={}),x=x[c],n[t].name=d.substring(0,p)+d.substring(p+1)))}}return{data:a,filesCount:i,roughSize:u}},a.ajax.submitAjax=function(t,r){(r=null!==r&&"object"==typeof r?r:{}).url=r.url||t.getAttribute("action");var o=r.data||{};for(var n in r.data=a.ajax.prepareForm(t).data,o)o.hasOwnProperty(n)&&(r.data[n]=o[n]);if(e.FormData){var s=function(e,a,t){if(t&&"object"==typeof t&&!function(e){var a=Object.prototype.toString.call(e);return"[object File]"==a||"[object Blob]"==a}(t))for(var r in t)t.hasOwnProperty(r)&&s(e,""==a?r:a+"["+r+"]",t[r]);else e.append(a,t||"")},i=function(e){var t={};if(null!=e)if("object"==typeof e){for(var r in e)if(e.hasOwnProperty(r)){var o=a.util.urlencode(r);"object"==typeof e[r]&&!0!==e[r].file?t[o]=i(e[r]):!0===e[r].file?t[o]=e[r].value:t[o]=a.util.urlencode(e[r])}}else t=a.util.urlencode(e);return t},u=new e.FormData;"POST"!==r.method?(r.data=a.ajax.prepareData(r.data),r.data&&(r.url+=(-1!==r.url.indexOf("?")?"&":"?")+r.data,r.data="")):(!0===r.preparePost&&(r.data=i(r.data)),s(u,"",r.data),r.data=u),r.preparePost=!1,r.start=!1;var l=a.ajax(r);r.onprogress&&l.upload.addEventListener("progress",(function(e){var a=null;e.lengthComputable&&(e.total||e.totalSize)&&(a=100*e.loaded/(e.total||e.totalSize)),r.onprogress(e,a)})),l.send(u)}else a.ajax(r)},a.ajax.UpdatePageData=function(e){if(e.TITLE&&a.ajax.UpdatePageTitle(e.TITLE),(e.WINDOW_TITLE||e.TITLE)&&a.ajax.UpdateWindowTitle(e.WINDOW_TITLE||e.TITLE),e.NAV_CHAIN&&a.ajax.UpdatePageNavChain(e.NAV_CHAIN),e.CSS&&e.CSS.length>0&&a.loadCSS(e.CSS),e.SCRIPTS&&e.SCRIPTS.length>0){var t=function(r,o,n){if(o&&a.type.isArray(o.scripts))for(var s=0,i=e.SCRIPTS.length;s<i;s++)o.scripts.push({isInternal:!1,JS:e.SCRIPTS[s]});else a.loadScript(e.SCRIPTS,n);a.removeCustomEvent("onAjaxSuccess",t)};a.addCustomEvent("onAjaxSuccess",t)}else{var r=function(e,t,o){a.type.isFunction(o)&&o(),a.removeCustomEvent("onAjaxSuccess",r)};a.addCustomEvent("onAjaxSuccess",r)}},a.ajax.UpdatePageTitle=function(e){var t=a("pagetitle");t&&(t.removeChild(t.firstChild),t.firstChild?t.insertBefore(document.createTextNode(e),t.firstChild):t.appendChild(document.createTextNode(e)))},a.ajax.UpdateWindowTitle=function(e){document.title=e},a.ajax.UpdatePageNavChain=function(e){var t=a("navigation");t&&(t.innerHTML=e)},a.userOptions={options:null,bSend:!1,delay:5e3,path:"/bitrix/admin/user_options.php?"},a.userOptions.setAjaxPath=function(e){a.userOptions.path=-1==e.indexOf("?")?e+"?":e+"&"},a.userOptions.save=function(e,t,r,o,n){null==a.userOptions.options&&(a.userOptions.options={}),n=!!n,a.userOptions.options[e+"."+t+"."+r]=[e,t,r,o,n];var s=a.userOptions.__get();""!=s&&(document.cookie=a.message("COOKIE_PREFIX")+"_LAST_SETTINGS="+encodeURIComponent(s)+"&sessid="+a.bitrix_sessid()+"; expires=Thu, 31 Dec 2020 23:59:59 GMT; path=/;"),a.userOptions.bSend||(a.userOptions.bSend=!0,setTimeout((function(){a.userOptions.send(null)}),a.userOptions.delay))},a.userOptions.send=function(e){var t=a.userOptions.__get();a.userOptions.options=null,a.userOptions.bSend=!1,""!=t&&(document.cookie=a.message("COOKIE_PREFIX")+"_LAST_SETTINGS=; path=/;",a.ajax({method:"GET",dataType:"html",processData:!1,cache:!1,url:a.userOptions.path+t+"&sessid="+a.bitrix_sessid(),onsuccess:e}))},a.userOptions.del=function(e,t,r,o){a.ajax.get(a.userOptions.path+"action=delete&c="+e+"&n="+t+(1==r?"&common=Y":"")+"&sessid="+a.bitrix_sessid(),o)},a.userOptions.__get=function(){if(!a.userOptions.options)return"";var e,t,r="",o=-1,n="";for(t in a.userOptions.options)if(a.userOptions.options.hasOwnProperty(t)){n!=(e=a.userOptions.options[t])[0]+"."+e[1]&&(r+="&p["+ ++o+"][c]="+a.util.urlencode(e[0]),r+="&p["+o+"][n]="+a.util.urlencode(e[1]),1==e[4]&&(r+="&p["+o+"][d]=Y"),n=e[0]+"."+e[1]);var s=e[2],i=e[3];r+=null===s?"&p["+o+"][v]="+a.util.urlencode(i):"&p["+o+"][v]["+a.util.urlencode(s)+"]="+a.util.urlencode(i)}return r.substr(1)},a.ajax.history={expected_hash:"",obParams:null,obFrame:null,obImage:null,obTimer:null,bInited:!1,bHashCollision:!1,bPushState:!(!history.pushState||!a.type.isFunction(history.pushState)),startState:null,init:function(t){if(!a.ajax.history.bInited){this.obParams=t;var r=this.obParams.getState();a.ajax.history.bPushState?(a.ajax.history.expected_hash=e.location.pathname,e.location.search&&(a.ajax.history.expected_hash+=e.location.search),a.ajax.history.put(r,a.ajax.history.expected_hash,"",!0),setTimeout((function(){a.bind(e,"popstate",a.ajax.history.__hashListener)}),500)):(a.ajax.history.expected_hash=e.location.hash,a.ajax.history.expected_hash&&"#"!=a.ajax.history.expected_hash||(a.ajax.history.expected_hash="__bx_no_hash__"),c.put(a.ajax.history.expected_hash,r),a.ajax.history.obTimer=setTimeout(a.ajax.history.__hashListener,500),a.browser.IsIE()?(a.ajax.history.obFrame=document.createElement("IFRAME"),a.hide_object(a.ajax.history.obFrame),document.body.appendChild(a.ajax.history.obFrame),a.ajax.history.obFrame.contentWindow.document.open(),a.ajax.history.obFrame.contentWindow.document.write(a.ajax.history.expected_hash),a.ajax.history.obFrame.contentWindow.document.close()):a.browser.IsOpera()&&(a.ajax.history.obImage=document.createElement("IMG"),a.hide_object(a.ajax.history.obImage),document.body.appendChild(a.ajax.history.obImage),a.ajax.history.obImage.setAttribute("src","javascript:location.href = 'javascript:BX.ajax.history.__hashListener();';"))),a.ajax.history.bInited=!0}},__hashListener:function(t){if(t=t||e.event||{state:!1},a.ajax.history.bPushState)a.ajax.history.obParams.setState(t.state||a.ajax.history.startState);else{var r;if(a.ajax.history.obTimer&&(e.clearTimeout(a.ajax.history.obTimer),a.ajax.history.obTimer=null),(r=null!=a.ajax.history.obFrame?a.ajax.history.obFrame.contentWindow.document.body.innerText:e.location.hash)&&"#"!=r||(r="__bx_no_hash__"),0==r.indexOf("#")&&(r=r.substring(1)),r!=a.ajax.history.expected_hash){var o=c.get(r);if(o&&(a.ajax.history.obParams.setState(o),a.ajax.history.expected_hash=r,null!=a.ajax.history.obFrame)){var n="__bx_no_hash__"==r?"":r;e.location.hash!=n&&e.location.hash!="#"+n&&(e.location.hash=n)}}a.ajax.history.obTimer=setTimeout(a.ajax.history.__hashListener,500)}},put:function(t,r,o,n){this.bPushState?n?a.ajax.history.startState=t:history.pushState(t,"",r):(r=void 0!==o?o:"view"+r,c.put(r,t),a.ajax.history.expected_hash=r,e.location.hash=a.util.urlencode(r),null!=a.ajax.history.obFrame&&(a.ajax.history.obFrame.contentWindow.document.open(),a.ajax.history.obFrame.contentWindow.document.write(r),a.ajax.history.obFrame.contentWindow.document.close()))},checkRedirectStart:function(t,r){var o=e.location.hash;"#"==o.substring(0,1)&&(o=o.substring(1));var n=o.substring(0,5);"view/"!=n&&"view%"!=n||(a.ajax.history.bHashCollision=!0,document.write('<div id="__ajax_hash_collision_'+r+'" style="display: none;">'))},checkRedirectFinish:function(t,r){document.write("</div>");var o=e.location.hash;"#"==o.substring(0,1)&&(o=o.substring(1)),a.ready((function(){var e=o.substring(0,5);if("view/"==e||"view%"==e){var n=a("__ajax_hash_collision_"+r),s=n.firstChild;a.cleanNode(s),n.style.display="block","view%"!=e&&(o=a.util.urlencode(o));var i="/bitrix/tools/ajax_redirector.php?hash="+(o+=(-1==o.indexOf("%3F")?"%3F":"%26")+t+"="+r);a.ajax.insertToNode(i,s)}}))}},a.ajax.component=function(e){this.node=e},a.ajax.component.prototype.getState=function(){var t={node:this.node,title:e.document.title,data:a(this.node).innerHTML},r=a("navigation");return null!=r&&(t.nav_chain=r.innerHTML),a.onCustomEvent(a(t.node),"onComponentAjaxHistoryGetState",[t]),t},a.ajax.component.prototype.setState=function(e){a(e.node).innerHTML=e.data,a.ajax.UpdatePageTitle(e.title),e.nav_chain&&a.ajax.UpdatePageNavChain(e.nav_chain),a.onCustomEvent(a(e.node),"onComponentAjaxHistorySetState",[e])};var c={arHistory:{},put:function(e,a){this.arHistory[e]=a},get:function(e){return this.arHistory[e]}};a.ajax.FormData=function(){this.elements=[],this.files=[],this.features={},this.isSupported(),this.log("BX FormData init")},a.ajax.FormData.isSupported=function(){var e=new a.ajax.FormData,t=e.features.supported;return e=null,t},a.ajax.FormData.prototype.log=function(e){0},a.ajax.FormData.prototype.isSupported=function(){var a={};return a.fileReader=e.FileReader&&e.FileReader.prototype.readAsBinaryString,a.readFormData=a.sendFormData=!!e.FormData,a.supported=!(!a.readFormData||!a.sendFormData),this.features=a,this.log("features:"),this.log(a),a.supported},a.ajax.FormData.prototype.append=function(e,a){"object"==typeof a?this.files.push({name:e,value:a}):this.elements.push({name:e,value:a})},a.ajax.FormData.prototype.send=function(e,t,r,o){if(this.log("FD send"),this.xhr=a.ajax({method:"POST",dataType:"html",url:e,onsuccess:t,onfailure:o,start:!1,preparePost:!1}),r&&this.xhr.upload.addEventListener("progress",(function(e){e.lengthComputable&&r(e.loaded/(e.total||e.totalSize))}),!1),this.features.readFormData&&this.features.sendFormData){var n=new FormData;for(var s in this.log("use browser formdata"),this.elements)this.elements.hasOwnProperty(s)&&n.append(this.elements[s].name,this.elements[s].value);for(s in this.files)this.files.hasOwnProperty(s)&&n.append(this.files[s].name,this.files[s].value);this.xhr.send(n)}return this.xhr},a.addCustomEvent("onAjaxFailure",a.debug)}}(window);